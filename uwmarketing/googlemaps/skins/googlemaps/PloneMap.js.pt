<tal:block define="_dummy python:request.response.setHeader('content-type','text/javascript;;charset=utf-8')" />
<metal:block i18n:domain="uwmarketing.googlemaps">

var PloneMap = PloneMap || {} ;

PloneMap.prototype = new google.maps.MVCObject();

PloneMap.prototype.SITE_URL = '<tal:block tal:replace="context/absolute_url"/>';

PloneMap.prototype.CURRENT_URL = '<tal:block tal:replace="context/absolute_url"/>';

PloneMap.init = function ( ) {

    document.getElementById( 'googleMapPane' ).style.height = 475 + 'px';

    var map = new PloneMap.Map( document.getElementById( 'googleMapPane' ) );
    
    var markers  = (typeof PloneMapMarkers  != 'undefined' ) ? PloneMapMarkers  : {};

    var polygons = (typeof PloneMapPolygons != 'undefined' ) ? PloneMapPolygons : {};

    for (var i = 0, l = markers.length; i < l; i++) {

        var marker = PloneMapMarkers[ i ];

        new PloneMap.Marker( marker.type , marker.options );

    };

        
    for (var region in polygons ) {

        var options = {
                        paths  : polygons[ region ],
                      };

        new PloneMap.Polygon( region , options );
    
         

    };
}

google.maps.event.addDomListener(window, 'load', PloneMap.init);

</metal:block>
